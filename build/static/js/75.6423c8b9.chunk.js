"use strict";(self.webpackChunkNeorain=self.webpackChunkNeorain||[]).push([[75],{1075:(e,t,i)=>{i.r(t),i.d(t,{default:()=>f});var a=i(9379),l=i(5043),n=i(4674),s=i(7073),r=i(9739),c=i(1802),o=i(6252),d=i(5397),u=i(644),y=i(2058),v=i(4442),m=i(9456),h=i(6178),p=i.n(h),g=i(2104),x=i(7503),A=i(579);const{Option:j}=n.A,f=()=>{const[e,t]=(0,l.useState)([]),[i,h]=(0,l.useState)(!0),[f,w]=(0,l.useState)(""),[k,S]=(0,l.useState)([]),[C,b]=(0,l.useState)(null),[E,D]=(0,l.useState)(""),[F,I]=(0,l.useState)(null),[N,z]=(0,l.useState)(null),{user:K}=(0,m.d4)((e=>e));(0,l.useEffect)((()=>{const e=(0,g.Ay)("https://user-analytics-system-825467496328.us-central1.run.app");return e.on("newActivityrecord",(e=>{t((t=>{const i=[...t,e];return S(i),x.oR.success("New activity recorded: ".concat(e.activity)),i}))})),()=>{e.disconnect()}}),[]),(0,l.useEffect)((()=>{(async()=>{try{const e=await(0,v.V9)(K.token);if(e&&e.data){const i=e.data.map((e=>{const t=e.action;let i="",a="",l="";return"string"===typeof t?i=t:"object"===typeof t&&(i=t.activity||"Unknown Activity",a=t.email||"",l=t.timestamp||""),{id:e.id,activity:i,email:a,timestamp:l}}));t(i),S(i),h(!1)}else h(!1)}catch(e){console.error("Error fetching activities:",e),h(!1)}})()}),[K.token]);const L=()=>{b(null),D(""),I(null),w(""),z(null),S(e)},R=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,s=e.filter((e=>e.activity.toLowerCase().includes(t.toLowerCase())&&(!i||e.activity.includes(i))&&(!a||e.email.includes(a))&&(!l||p()(e.timestamp).isSame(l,"day"))&&(!n||e.email===n)));S(s)},U=e=>({filterDropdown:t=>{let{setSelectedKeys:i,selectedKeys:a,confirm:l,clearFilters:n}=t;return(0,A.jsxs)("div",{style:{padding:8},children:[(0,A.jsx)(s.A,{autoFocus:!0,placeholder:"Search ".concat(e),value:a[0],onChange:e=>i(e.target.value?[e.target.value]:[]),onPressEnter:()=>l(),style:{marginBottom:8,display:"block"}}),(0,A.jsxs)(r.A,{children:[(0,A.jsx)(c.A,{type:"primary",onClick:()=>{var e;l(),e={target:{value:a[0]}},w(e.target.value),R(e.target.value,C,E,F,N)},icon:(0,A.jsx)(y.A,{}),size:"small",style:{width:90},children:"Search"}),(0,A.jsx)(c.A,{onClick:()=>{n&&n(),L()},size:"small",style:{width:90},children:"Reset"})]})]})},filterIcon:e=>(0,A.jsx)(y.A,{style:{color:e?"#1890ff":void 0}})}),B=[...new Set(e.map((e=>e.activity)))],O=[(0,a.A)((0,a.A)({title:"Activity",dataIndex:"activity",key:"activity"},U("activity")),{},{filterDropdown:(0,A.jsx)("div",{style:{padding:8},children:(0,A.jsx)(n.A,{placeholder:"Filter by Activity",style:{width:200},onChange:e=>{b(e),R(f,e,E,F,N)},value:C,children:B.map(((e,t)=>(0,A.jsx)(j,{value:e,children:e},t)))})})}),(0,a.A)((0,a.A)({title:"Email",dataIndex:"email",key:"email"},U("email")),{},{filterDropdown:(0,A.jsx)("div",{style:{padding:8},children:(0,A.jsx)(s.A,{placeholder:"Filter by Email",value:E,onChange:e=>{const t=e.target.value;D(t),R(f,C,t,F,N)}})})}),{title:"Timestamp",dataIndex:"timestamp",key:"timestamp",render:e=>new Date(e).toLocaleString(),filterDropdown:(0,A.jsx)("div",{style:{padding:8},children:(0,A.jsx)(o.A,{onChange:(e,t)=>{I(t),R(f,C,E,t,N)}})})}];return(0,A.jsxs)("div",{children:[(0,A.jsx)("h1",{className:"text-center text-danger",children:"User Activities"}),(0,A.jsxs)(r.A,{style:{marginBottom:16},children:[(0,A.jsx)(c.A,{onClick:()=>{var t;const i=e.reduce(((e,t)=>(e[t.email]=(e[t.email]||0)+1,e)),{}),a=null===(t=Object.entries(i).sort(((e,t)=>t[1]-e[1]))[0])||void 0===t?void 0:t[0];z(a),R(f,C,E,F,a)},type:"primary",children:"Most Active User"}),(0,A.jsx)(c.A,{onClick:L,children:"Reset Filters"})]}),i?(0,A.jsx)(d.A,{size:"large"}):(0,A.jsx)(u.A,{columns:O,dataSource:k,rowKey:"id",pagination:!1})]})}}}]);
//# sourceMappingURL=75.6423c8b9.chunk.js.map